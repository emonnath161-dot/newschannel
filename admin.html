<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adi Sonaton TV | Master Dashboard</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        :root { --sidebar: #0f172a; --primary: #2563eb; --success: #10b981; --danger: #ef4444; --light: #f8fafc; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Hind Siliguri', sans-serif; }
        body { background: #f1f5f9; display: flex; min-height: 100vh; }

        /* Login Overlay */
        #login-overlay { position: fixed; inset: 0; background: var(--sidebar); z-index: 10000; display: flex; align-items: center; justify-content: center; }
        .login-card { background: white; padding: 40px; border-radius: 15px; width: 350px; text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.5); }

        /* Sidebar Navigation */
        .sidebar { width: 280px; background: var(--sidebar); color: white; height: 100vh; position: fixed; padding: 30px 20px; }
        .sidebar h2 { color: var(--primary); text-align: center; margin-bottom: 35px; font-size: 24px; border-bottom: 1px solid #334155; padding-bottom: 15px; }
        .nav-btn { width: 100%; padding: 14px; margin-bottom: 10px; border: none; background: transparent; color: #94a3b8; text-align: left; border-radius: 10px; cursor: pointer; font-size: 16px; font-weight: 600; transition: 0.3s; }
        .nav-btn i { margin-right: 12px; width: 20px; }
        .nav-btn:hover, .nav-btn.active { background: #1e293b; color: white; }
        .nav-btn.active { border-left: 4px solid var(--primary); }

        /* Main Content */
        .main-content { margin-left: 280px; width: calc(100% - 280px); padding: 40px; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 30px; }
        .section { display: none; }
        .active { display: block; }

        /* Form Controls */
        label { display: block; margin-bottom: 8px; font-weight: 700; color: #334155; }
        input, select, textarea { width: 100%; padding: 12px; margin-bottom: 20px; border: 1.5px solid #e2e8f0; border-radius: 10px; outline: none; font-size: 15px; }
        .btn-submit { background: var(--primary); color: white; border: none; padding: 15px; border-radius: 10px; width: 100%; font-size: 18px; font-weight: 700; cursor: pointer; }
        .btn-add-more { background: var(--success); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; margin-bottom: 20px; }
        
        /* Dynamic Row Style */
        .extra-row { background: #f8fafc; border: 1px dashed #cbd5e1; padding: 20px; border-radius: 12px; margin-bottom: 15px; position: relative; }
        .btn-remove { position: absolute; top: 10px; right: 10px; color: var(--danger); border: none; background: none; font-size: 20px; cursor: pointer; }

        /* Preview Item */
        .list-item { display: flex; align-items: center; justify-content: space-between; background: white; padding: 15px; border-radius: 12px; border: 1px solid #e2e8f0; margin-bottom: 10px; }
        .list-item img { width: 70px; height: 45px; object-fit: cover; border-radius: 6px; }
    </style>
</head>
<body>

<div id="login-overlay">
    <div class="login-card">
        <i class="fas fa-shield-alt" style="font-size: 45px; color: var(--primary); margin-bottom: 15px;"></i>
        <h2>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂</h2><br>
        <input type="password" id="admin-pass" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®">
        <button class="btn-submit" onclick="login()">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>
</div>

<div class="sidebar">
    <h2>Adi Sonaton TV</h2>
    <button class="nav-btn active" onclick="showSec('news-sec', this)"><i class="fas fa-newspaper"></i> ‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶™‡ßã‡¶∏‡ßç‡¶ü</button>
    <button class="nav-btn" onclick="showSec('video-sec', this)"><i class="fas fa-play-circle"></i> ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø</button>
    <button class="nav-btn" onclick="showSec('opinion-sec', this)"><i class="fas fa-comments"></i> ‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§ ‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°‡¶æ‡¶∞</button>
    <button class="nav-btn" onclick="window.location.href='index.html'" style="margin-top:50px;"><i class="fas fa-home"></i> ‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
</div>

<div class="main-content">
    
    <div id="news-sec" class="section active">
        <div class="card">
            <h3>üì∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</h3><br>
            <label>‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ</label>
            <input type="text" id="n-title" placeholder="‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">

            <label>‡¶™‡ßá‡¶ú ‡¶¨‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</label>
            <select id="n-cat">
                <option value="bangladesh">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂</option>
                <option value="national">‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º</option>
                <option value="international">‡¶Ü‡¶®‡ßç‡¶§‡¶∞‡ßç‡¶ú‡¶æ‡¶§‡¶ø‡¶ï</option>
                <option value="sports">‡¶ñ‡ßá‡¶≤‡¶æ</option>
                <option value="entertainment">‡¶¨‡¶ø‡¶®‡ßã‡¶¶‡¶®</option>
                <option value="theology">‡¶ß‡¶∞‡ßç‡¶Æ‡¶§‡¶§‡ßç‡¶¨</option>
                <option value="festivals">‡¶™‡ßÇ‡¶ú‡¶æ‡¶™‡¶æ‡¶∞‡ßç‡¶¨‡¶£</option>
                <option value="foundation">‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ ‡¶´‡¶æ‡¶â‡¶®‡ßç‡¶°‡ßá‡¶∂‡¶®</option>
                <option value="organization">‡¶∏‡¶Ç‡¶ó‡¶†‡¶®</option>
                <option value="education">‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ</option>
                <option value="health">‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø</option>
                <option value="opinion">‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§</option>
            </select>

            <label>‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï (URL)</label>
            <input type="text" id="n-img" placeholder="https://example.com/image.jpg">

            <label>‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ (‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§)</label>
            <textarea id="n-body" rows="6" placeholder="‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶‡¶ü‡¶ø ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..."></textarea>

            <div id="dynamic-container"></div>
            <button class="btn-add-more" onclick="addMore()"><i class="fas fa-plus-circle"></i> ‡¶®‡¶§‡ßÅ‡¶® ‡¶õ‡¶¨‡¶ø ‡¶ì ‡¶°‡ßá‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>

            <button class="btn-submit" id="save-news" onclick="publishNews()">‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>

        <h4>‡¶∏‡¶æ‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï ‡¶™‡ßã‡¶∏‡ßç‡¶ü‡¶∏‡¶Æ‡ßÇ‡¶π (‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â)</h4><br>
        <div id="news-preview-list">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
    </div>

    <div id="video-sec" class="section">
        <div class="card">
            <h3>üé• ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø</h3><br>
            <input type="text" id="v-url" placeholder="YouTube Embed URL (src)">
            <input type="text" id="v-title" placeholder="‡¶≠‡¶ø‡¶°‡¶ø‡¶ì‡¶∞ ‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ">
            <button class="btn-submit" onclick="saveVideo()">‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
        <div id="video-list"></div>
    </div>

    <div id="opinion-sec" class="section">
        <div class="card">
            <h3>‚úçÔ∏è ‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§ ‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°‡¶æ‡¶∞</h3><br>
            <input type="text" id="o-img" placeholder="‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï (URL)">
            <button class="btn-submit" onclick="saveOpinion()">‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°‡¶æ‡¶∞‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
        <div id="opinion-list"></div>
    </div>

</div>

<script>
    const S_URL = 'https://vplqtnrziptqeeusdabv.supabase.co';
    const S_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZwbHF0bnJ6aXB0cWVldXNkYWJ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEwNDU1NDIsImV4cCI6MjA4NjYyMTU0Mn0.yMs0N0dMIImliu6PscOeKh_gYlvl184AESug-LVDKok';
    const client = supabase.createClient(S_URL, S_KEY);

    function login() {
        if(document.getElementById('admin-pass').value === "sonaton2026") {
            document.getElementById('login-overlay').style.display = 'none';
        } else { alert("‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°!"); }
    }

    function showSec(id, btn) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
        if(id === 'news-sec') fetchNews();
    }

    // ‡¶®‡¶§‡ßÅ‡¶® ‡¶õ‡¶¨‡¶ø ‡¶ì ‡¶°‡ßá‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶® ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    function addMore() {
        const div = document.createElement('div');
        div.className = 'extra-row';
        div.innerHTML = `
            <button class="btn-remove" onclick="this.parentElement.remove()"><i class="fas fa-times-circle"></i></button>
            <label>‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï</label>
            <input type="text" class="ex-img" placeholder="‡¶®‡¶§‡ßÅ‡¶® ‡¶õ‡¶¨‡¶ø‡¶∞ URL">
            <label>‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶°‡ßá‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶®</label>
            <textarea class="ex-desc" rows="2" placeholder="‡¶è‡¶á ‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..."></textarea>
        `;
        document.getElementById('dynamic-container').appendChild(div);
    }

    // ‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶∏‡ßá‡¶≠ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    async function submitNews() {
    const btn = document.getElementById('save-news'); // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶®‡ßá‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶π‡ßã‡¶®
    const title = document.getElementById('n-title').value;
    const category = document.getElementById('n-cat').value;
    const image_url = document.getElementById('n-img').value;
    const content = document.getElementById('n-body').value;

    // ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶õ‡¶¨‡¶ø ‡¶ì ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ‡¶∞ ‡¶á‡¶®‡¶™‡ßÅ‡¶ü‡¶ó‡ßÅ‡¶≤‡ßã ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π
    const extraImgs = Array.from(document.querySelectorAll('.ex-img')).map(i => i.value).filter(val => val !== "");
    const extraDescs = Array.from(document.querySelectorAll('.ex-desc')).map(d => d.value).filter(val => val !== "");

    if(!title || !image_url || !content) return alert("‡¶¶‡ßü‡¶æ ‡¶ï‡¶∞‡ßá ‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ, ‡¶õ‡¶¨‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");

    btn.disabled = true; 
    btn.innerText = "‡¶∏‡ßá‡¶≠ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";

    try {
        const { error } = await client.from('news_portal').insert([{
            title: title, 
            category: category, 
            image_url: image_url, 
            content: content,
            extra_images: extraImgs,       // ‡¶è‡¶ñ‡¶® ‡¶è‡¶ü‡¶ø ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶ú‡ßá‡¶∞ ‡¶ï‡¶≤‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Æ‡¶ø‡¶≤‡¶¨‡ßá
            extra_descriptions: extraDescs  // ‡¶è‡¶ñ‡¶® ‡¶è‡¶ü‡¶ø ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶ú‡ßá‡¶∞ ‡¶ï‡¶≤‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Æ‡¶ø‡¶≤‡¶¨‡ßá
        }]);

        if (error) {
            console.error("Supabase Error:", error);
            alert("‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: " + error.message);
        } else {
            alert("‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶‡¶ü‡¶ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂‡¶ø‡¶§ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
            location.reload(); 
        }
    } catch (err) {
        alert("‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡¶∂‡¶® ‡¶è‡¶∞‡¶∞! ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
    } finally {
        btn.disabled = false;
        btn.innerText = "‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®";
    }
}
    // ‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶°
    async function fetchNews() {
        const { data } = await client.from('news_portal').select('*').order('id', {ascending: false});
        if(data) {
            document.getElementById('news-preview-list').innerHTML = data.map(n => `
                <div class="list-item">
                    <div style="display:flex; align-items:center;"><img src="${n.image_url}"> <b style="margin-left:15px">${n.title}</b></div>
                    <button onclick="delData('news_portal', ${n.id})" style="color:red; border:none; background:none; cursor:pointer;"><i class="fas fa-trash-alt"></i></button>
                </div>
            `).join('');
        }
    }

    async function delData(table, id) {
        if(confirm("‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶¨‡ßá‡¶®?")) {
            await client.from(table).delete().eq('id', id);
            location.reload();
        }
    }

    window.onload = fetchNews;
</script>
</body>
</html>

