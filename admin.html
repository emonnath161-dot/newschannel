<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adi Sonaton TV | Master Admin</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        :root {
            --sidebar-color: #0f172a;
            --primary: #2563eb;
            --danger: #dc2626;
            --success: #16a34a;
            --bg: #f1f5f9;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Hind Siliguri', sans-serif; }
        body { background: var(--bg); display: flex; min-height: 100vh; }

        /* Login Overlay */
        #login-overlay { position: fixed; inset: 0; background: #0f172a; z-index: 9999; display: flex; align-items: center; justify-content: center; }
        .login-card { background: white; padding: 40px; border-radius: 15px; width: 350px; text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.5); }

        /* Sidebar */
        .sidebar { width: 280px; background: var(--sidebar-color); color: white; height: 100vh; position: fixed; padding: 30px 20px; }
        .sidebar h2 { color: var(--primary); margin-bottom: 40px; text-align: center; font-size: 24px; }
        .nav-btn { width: 100%; padding: 15px; margin-bottom: 10px; border: none; background: transparent; color: #94a3b8; text-align: left; border-radius: 10px; cursor: pointer; font-size: 16px; font-weight: 600; transition: 0.3s; }
        .nav-btn i { margin-right: 12px; width: 20px; }
        .nav-btn:hover, .nav-btn.active { background: #1e293b; color: white; }
        .nav-btn.active { border-left: 4px solid var(--primary); }

        /* Main Content */
        .main-content { margin-left: 280px; width: calc(100% - 280px); padding: 40px; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); margin-bottom: 30px; }
        .section { display: none; }
        .section.active { display: block; animation: fadeIn 0.4s ease; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Forms */
        label { display: block; margin-bottom: 8px; font-weight: 700; color: #334155; }
        input, select, textarea { width: 100%; padding: 12px; margin-bottom: 20px; border: 1.5px solid #e2e8f0; border-radius: 10px; font-size: 15px; outline: none; }
        input:focus { border-color: var(--primary); }
        .btn-submit { background: var(--primary); color: white; border: none; padding: 15px; border-radius: 10px; width: 100%; font-size: 18px; font-weight: 700; cursor: pointer; transition: 0.3s; }
        .btn-submit:hover { background: #1d4ed8; transform: translateY(-2px); }

        /* Preview List */
        .preview-box { margin-top: 20px; border-top: 2px solid #e2e8f0; padding-top: 20px; }
        .list-item { display: flex; align-items: center; justify-content: space-between; background: #fff; padding: 15px; border-radius: 12px; margin-bottom: 10px; border: 1px solid #e2e8f0; }
        .list-item img { width: 70px; height: 45px; object-fit: cover; border-radius: 6px; margin-right: 15px; }
        .del-btn { color: var(--danger); cursor: pointer; font-size: 20px; border: none; background: none; }
    </style>
</head>
<body>

<div id="login-overlay">
    <div class="login-card">
        <i class="fas fa-lock" style="font-size: 40px; color: var(--primary); margin-bottom: 15px;"></i>
        <h2>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶®</h2><br>
        <input type="password" id="admin-pass" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®">
        <button class="btn-submit" onclick="verifyLogin()">‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>
</div>

<div class="sidebar">
    <h2>Adi Sonaton</h2>
    <button class="nav-btn active" onclick="switchTab('news-tab', this)"><i class="fas fa-newspaper"></i> ‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶™‡ßã‡¶∏‡ßç‡¶ü</button>
    <button class="nav-btn" onclick="switchTab('video-tab', this)"><i class="fas fa-play-circle"></i> ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø</button>
    <button class="nav-btn" onclick="switchTab('opinion-tab', this)"><i class="fas fa-user-edit"></i> ‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§ ‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°‡¶æ‡¶∞</button>
    <button class="nav-btn" onclick="window.location.href='index.html'" style="margin-top: 60px;"><i class="fas fa-home"></i> ‡¶π‡ßã‡¶Æ‡¶™‡ßá‡¶ú‡ßá ‡¶Ø‡¶æ‡¶®</button>
</div>

<div class="main-content">
    
    <div id="news-tab" class="section active">
        <div class="card">
            <h2>üì∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</h2><br>
            <label>‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ</label>
            <input type="text" id="n-title" placeholder="‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">

            <label>‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶® (‡¶°‡ßç‡¶∞‡¶™‡¶°‡¶æ‡¶â‡¶®)</label>
            <select id="n-cat">
                <option value="bangladesh">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂</option>
                <option value="national">‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º</option>
                <option value="international">‡¶Ü‡¶®‡ßç‡¶§‡¶∞‡ßç‡¶ú‡¶æ‡¶§‡¶ø‡¶ï</option>
                <option value="sports">‡¶ñ‡ßá‡¶≤‡¶æ</option>
                <option value="entertainment">‡¶¨‡¶ø‡¶®‡ßã‡¶¶‡¶®</option>
                <option value="theology">‡¶ß‡¶∞‡ßç‡¶Æ‡¶§‡¶§‡ßç‡¶¨</option>
                <option value="opinion">‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§</option>
                <option value="tech">‡¶™‡ßç‡¶∞‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶ø</option>
                <option value="festivals">‡¶™‡ßÇ‡¶ú‡¶æ‡¶™‡¶æ‡¶∞‡ßç‡¶¨‡¶£</option>
                <option value="foundation">‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ ‡¶´‡¶æ‡¶â‡¶®‡ßç‡¶°‡ßá‡¶∂‡¶®</option>
                <option value="organization">‡¶∏‡¶Ç‡¶ó‡¶†‡¶®</option>
                <option value="education">‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ</option>
            </select>

            <label>‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï (URL)</label>
            <input type="text" id="n-img" placeholder="https://example.com/photo.jpg">

            <label>‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ</label>
            <textarea id="n-body" rows="6" placeholder="‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..."></textarea>

            <button class="btn-submit" id="save-news-btn" onclick="submitNews()">‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>

        <div class="preview-box">
            <h3>‡¶∏‡¶æ‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï ‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶‡¶∏‡¶Æ‡ßÇ‡¶π (‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â)</h3><br>
            <div id="news-preview-list">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
        </div>
    </div>

    <div id="video-tab" class="section">
        <div class="card">
            <h2>üé• ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü</h2><br>
            <input type="text" id="v-url" placeholder="YouTube Embed URL (src)">
            <input type="text" id="v-title" placeholder="‡¶≠‡¶ø‡¶°‡¶ø‡¶ì‡¶∞ ‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ">
            <button class="btn-submit" onclick="submitVideo()">‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
        <div id="video-preview-list" class="preview-box"></div>
    </div>

    <div id="opinion-tab" class="section">
        <div class="card">
            <h2>‚úçÔ∏è ‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§ ‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶ú</h2><br>
            <input type="text" id="o-img" placeholder="‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶¶‡¶ø‡¶® (URL)">
            <button class="btn-submit" onclick="submitOpinion()">‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°‡¶æ‡¶∞‡ßá ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
        <div id="opinion-preview-list" class="preview-box"></div>
    </div>

</div>

<script>
    const S_URL = 'https://vplqtnrziptqeeusdabv.supabase.co';
    const S_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZwbHF0bnJ6aXB0cWVldXNkYWJ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEwNDU1NDIsImV4cCI6MjA4NjYyMTU0Mn0.yMs0N0dMIImliu6PscOeKh_gYlvl184AESug-LVDKok';
    const supabaseClient = supabase.createClient(S_URL, S_KEY);

    // ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶®
    function verifyLogin() {
        const p = document.getElementById('admin-pass').value;
        if(p === "sonaton2026") {
            document.getElementById('login-overlay').style.display = 'none';
        } else { alert("‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°! ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§"); }
    }

    // ‡¶ü‡ßç‡¶Ø‡¶æ‡¶¨ ‡¶∏‡ßÅ‡¶á‡¶ö‡¶ø‡¶Ç
    function switchTab(id, btn) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
        if(id === 'news-tab') fetchNews();
        if(id === 'video-tab') fetchVideos();
        if(id === 'opinion-tab') fetchOpinions();
    }

    // ‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶∏‡ßá‡¶≠ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶è‡¶∞‡¶∞ ‡¶´‡¶ø‡¶ï‡ßç‡¶∏‡¶°)
    async function submitNews() {
        const btn = document.getElementById('save-news-btn');
        const title = document.getElementById('n-title').value;
        const cat = document.getElementById('n-cat').value;
        const img = document.getElementById('n-img').value;
        const body = document.getElementById('n-body').value;

        if(!title || !img || !body) return alert("‡¶∏‡¶¨‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ò‡¶∞ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®!");

        btn.disabled = true; btn.innerText = "‡¶∏‡ßá‡¶≠ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";

        // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶ú‡ßá ‡¶Ø‡¶¶‡¶ø 'content' ‡¶è‡¶∞‡¶∞ ‡¶¶‡ßá‡ßü, ‡¶§‡¶¨‡ßá ‡¶®‡¶ø‡¶ö‡ßá 'content' ‡¶è‡¶∞ ‡¶ú‡¶æ‡ßü‡¶ó‡¶æ‡ßü 'description' ‡¶≤‡¶ø‡¶ñ‡ßá ‡¶ü‡ßç‡¶∞‡¶æ‡¶á ‡¶ï‡¶∞‡ßÅ‡¶®‡•§
        const { error } = await supabaseClient.from('news_portal').insert([{
            title: title, 
            category: cat, 
            image_url: img, 
            content: body 
        }]);

        if(!error) { 
            alert("‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶‡¶ü‡¶ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡ßá‡¶≠ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶è‡¶¨‡¶Ç ‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü‡ßá ‡¶∂‡ßã ‡¶ï‡¶∞‡¶¨‡ßá‡•§"); 
            location.reload(); 
        } else { 
            alert("Error: " + error.message); 
            console.log(error);
        }
        btn.disabled = false; btn.innerText = "‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®";
    }

    // ‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶≤‡ßã‡¶° ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    async function fetchNews() {
        const { data } = await supabaseClient.from('news_portal').select('*').order('id', {ascending: false});
        const box = document.getElementById('news-preview-list');
        if(data) {
            box.innerHTML = data.map(n => `
                <div class="list-item">
                    <div style="display:flex; align-items:center;"><img src="${n.image_url}"> <b>${n.title}</b></div>
                    <button class="del-btn" onclick="delItem('news_portal', ${n.id})"><i class="fas fa-trash-alt"></i></button>
                </div>
            `).join('');
        }
    }

    async function submitVideo() {
        const u = document.getElementById('v-url').value;
        const t = document.getElementById('v-title').value;
        const { error } = await supabaseClient.from('videos').insert([{ video_url: u, caption: t }]);
        if(!error) { alert("‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∏‡ßá‡¶≠ ‡¶π‡ßü‡ßá‡¶õ‡ßá!"); fetchVideos(); }
    }

    async function fetchVideos() {
        const { data } = await supabaseClient.from('videos').select('*');
        document.getElementById('video-preview-list').innerHTML = data.map(v => `
            <div class="list-item"><span>${v.caption}</span> <button class="del-btn" onclick="delItem('videos', ${v.id})"><i class="fas fa-trash-alt"></i></button></div>
        `).join('');
    }

    async function submitOpinion() {
        const i = document.getElementById('o-img').value;
        const { error } = await supabaseClient.from('opinions').insert([{ image_url: i }]);
        if(!error) { alert("‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§ ‡¶á‡¶Æ‡ßá‡¶ú ‡¶∏‡ßá‡¶≠ ‡¶π‡ßü‡ßá‡¶õ‡ßá!"); fetchOpinions(); }
    }

    async function fetchOpinions() {
        const { data } = await supabaseClient.from('opinions').select('*');
        document.getElementById('opinion-preview-list').innerHTML = data.map(o => `
            <div class="list-item"><img src="${o.image_url}"> <button class="del-btn" onclick="delItem('opinions', ${o.id})"><i class="fas fa-trash-alt"></i></button></div>
        `).join('');
    }

    // ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    async function delItem(table, id) {
        if(confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶è‡¶ü‡¶ø ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®? ‡¶è‡¶ü‡¶ø ‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶•‡ßá‡¶ï‡ßá‡¶ì ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá‡•§")) {
            await supabaseClient.from(table).delete().eq('id', id);
            location.reload();
        }
    }

    window.onload = fetchNews;
</script>
</body>
</html>
