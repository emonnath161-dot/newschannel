<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adi Sonaton TV | Admin Dashboard</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        :root {
            --sidebar-color: #0f172a;
            --primary: #2563eb;
            --danger: #dc2626;
            --success: #16a34a;
            --bg: #f8fafc;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Hind Siliguri', sans-serif; }
        body { background: var(--bg); display: flex; min-height: 100vh; }

        /* Sidebar */
        .sidebar { width: 280px; background: var(--sidebar-color); color: white; height: 100vh; position: fixed; padding: 30px 20px; }
        .sidebar h2 { color: var(--primary); margin-bottom: 35px; text-align: center; }
        .nav-btn { width: 100%; padding: 15px; margin-bottom: 10px; border: none; background: transparent; color: #94a3b8; text-align: left; border-radius: 10px; cursor: pointer; font-size: 16px; transition: 0.3s; }
        .nav-btn i { margin-right: 12px; }
        .nav-btn:hover, .nav-btn.active { background: #1e293b; color: white; }
        .nav-btn.active { border-left: 4px solid var(--primary); }

        /* Main Area */
        .main-content { margin-left: 280px; width: calc(100% - 280px); padding: 40px; }
        .section { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); display: none; }
        .section.active { display: block; }

        /* Form */
        label { display: block; margin-bottom: 8px; font-weight: 600; color: #334155; }
        input, select, textarea { width: 100%; padding: 12px; margin-bottom: 20px; border: 1.5px solid #e2e8f0; border-radius: 8px; outline: none; }
        .btn-save { background: var(--primary); color: white; border: none; padding: 15px; border-radius: 8px; width: 100%; font-size: 18px; font-weight: 700; cursor: pointer; }
        .btn-save:hover { background: #1d4ed8; }

        /* Preview Table */
        .dashboard-preview { margin-top: 40px; }
        .preview-card { background: white; padding: 20px; border-radius: 12px; border: 1px solid #e2e8f0; margin-bottom: 10px; display: flex; align-items: center; justify-content: space-between; }
        .preview-card img { width: 80px; height: 50px; object-fit: cover; border-radius: 5px; margin-right: 15px; }
        .del-btn { color: var(--danger); cursor: pointer; font-size: 18px; border: none; background: none; }

        /* Extra Content Row */
        .extra-row { background: #f1f5f9; padding: 15px; border-radius: 8px; margin-bottom: 15px; position: relative; }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>Sonaton TV</h2>
    <button class="nav-btn active" onclick="showTab('news-tab', this)"><i class="fas fa-newspaper"></i> ‡¶®‡¶ø‡¶â‡¶ú ‡¶Ü‡¶™‡¶≤‡ßã‡¶°</button>
    <button class="nav-btn" onclick="showTab('video-tab', this)"><i class="fas fa-video"></i> ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø</button>
    <button class="nav-btn" onclick="showTab('opinion-tab', this)"><i class="fas fa-feather"></i> ‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§ ‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°‡¶æ‡¶∞</button>
    <button class="nav-btn" onclick="window.location.href='index.html'" style="margin-top: 50px;"><i class="fas fa-home"></i> ‡¶π‡ßã‡¶Æ‡¶™‡ßá‡¶ú‡ßá ‡¶Ø‡¶æ‡¶®</button>
</div>

<div class="main-content">
    
    <div id="news-tab" class="section active">
        <h3>üì∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</h3><br>
        <label>‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ</label>
        <input type="text" id="n-title">
        <label>‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø</label>
        <select id="n-cat">
            <option value="bangladesh">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂</option>
            <option value="national">‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º</option>
            <option value="international">‡¶Ü‡¶®‡ßç‡¶§‡¶∞‡ßç‡¶ú‡¶æ‡¶§‡¶ø‡¶ï</option>
            <option value="sports">‡¶ñ‡ßá‡¶≤‡¶æ</option>
            <option value="entertainment">‡¶¨‡¶ø‡¶®‡ßã‡¶¶‡¶®</option>
            <option value="opinion">‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§</option>
            <option value="theology">‡¶ß‡¶∞‡ßç‡¶Æ‡¶§‡¶§‡ßç‡¶¨</option>
            <option value="foundation">‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ ‡¶´‡¶æ‡¶â‡¶®‡ßç‡¶°‡ßá‡¶∂‡¶®</option>
        </select>
        <label>‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶õ‡¶¨‡¶ø (URL)</label>
        <input type="text" id="n-img">
        <label>‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ</label>
        <textarea id="n-body" rows="5"></textarea>

        <div id="extra-fields"></div>
        <button onclick="addExtra()" style="background:#10b981; color:white; padding:8px 15px; border:none; border-radius:5px; cursor:pointer; margin-bottom:20px;">+ ‡¶Ü‡¶∞‡ßã ‡¶õ‡¶¨‡¶ø ‡¶ì ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ</button>

        <button class="btn-save" onclick="saveNews()">‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        
        <div class="dashboard-preview">
            <h4>‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶™‡ßã‡¶∏‡ßç‡¶ü‡¶∏‡¶Æ‡ßÇ‡¶π (‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â)</h4><br>
            <div id="news-list-dashboard">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
        </div>
    </div>

    <div id="video-tab" class="section">
        <h3>üé• ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶Ü‡¶™‡¶≤‡ßã‡¶°</h3><br>
        <input type="text" id="v-url" placeholder="YouTube Embed URL">
        <input type="text" id="v-title" placeholder="‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ">
        <button class="btn-save" onclick="saveVideo()">‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        <div id="video-list-dashboard" class="dashboard-preview"></div>
    </div>

    <div id="opinion-tab" class="section">
        <h3>‚úçÔ∏è ‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§ ‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶ú</h3><br>
        <input type="text" id="o-url" placeholder="‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï (URL)">
        <button class="btn-save" onclick="saveOpinion()">‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°‡¶æ‡¶∞‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        <div id="opinion-list-dashboard" class="dashboard-preview"></div>
    </div>

</div>

<script>
    const S_URL = 'https://vplqtnrziptqeeusdabv.supabase.co';
    const S_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZwbHF0bnJ6aXB0cWVldXNkYWJ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEwNDU1NDIsImV4cCI6MjA4NjYyMTU0Mn0.yMs0N0dMIImliu6PscOeKh_gYlvl184AESug-LVDKok';
    const supabaseClient = supabase.createClient(S_URL, S_KEY);

    // ‡¶ü‡ßç‡¶Ø‡¶æ‡¶¨ ‡¶™‡¶æ‡¶≤‡ßç‡¶ü‡¶æ‡¶®‡ßã
    function showTab(id, btn) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
        if(id === 'news-tab') loadNews();
        if(id === 'video-tab') loadVideos();
        if(id === 'opinion-tab') loadOpinions();
    }

    // ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶´‡¶ø‡¶≤‡ßç‡¶°
    function addExtra() {
        const div = document.createElement('div');
        div.className = 'extra-row';
        div.innerHTML = `<input type="text" class="ex-i" placeholder="‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶õ‡¶¨‡¶ø"><textarea class="ex-d" placeholder="‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ"></textarea><button onclick="this.parentElement.remove()" style="color:red; border:none; background:none; cursor:pointer;">‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡ßÅ‡¶®</button>`;
        document.getElementById('extra-fields').appendChild(div);
    }

    // ‡¶®‡¶ø‡¶â‡¶ú ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ
    async function saveNews() {
        const title = document.getElementById('n-title').value;
        const cat = document.getElementById('n-cat').value;
        const img = document.getElementById('n-img').value;
        const body = document.getElementById('n-body').value;
        const exI = Array.from(document.querySelectorAll('.ex-i')).map(i => i.value);
        const exD = Array.from(document.querySelectorAll('.ex-d')).map(d => d.value);

        if(!title || !img) return alert("‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®");

        const { error } = await supabaseClient.from('news_portal').insert([{ 
            title: title, category: cat, image_url: img, content: body, 
            extra_images: exI, extra_descriptions: exD 
        }]);

        if(!error) { alert("‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶∏‡¶´‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá!"); loadNews(); }
        else { alert("Error: " + error.message); }
    }

    // ‡¶®‡¶ø‡¶â‡¶ú ‡¶≤‡ßã‡¶° (‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â)
    async function loadNews() {
        const { data } = await supabaseClient.from('news_portal').select('*').order('id', {ascending: false});
        const box = document.getElementById('news-list-dashboard');
        if(data) {
            box.innerHTML = data.map(n => `
                <div class="preview-card">
                    <div style="display:flex; align-items:center;"><img src="${n.image_url}"> <b>${n.title}</b></div>
                    <button class="del-btn" onclick="deleteData('news_portal', ${n.id})"><i class="fas fa-trash"></i></button>
                </div>
            `).join('');
        }
    }

    // ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∏‡ßá‡¶≠
    async function saveVideo() {
        const url = document.getElementById('v-url').value;
        const title = document.getElementById('v-title').value;
        await supabaseClient.from('videos').insert([{ video_url: url, caption: title }]);
        alert("‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∏‡ßá‡¶≠ ‡¶π‡ßü‡ßá‡¶õ‡ßá"); loadVideos();
    }

    async function loadVideos() {
        const { data } = await supabaseClient.from('videos').select('*');
        document.getElementById('video-list-dashboard').innerHTML = data.map(v => `
            <div class="preview-card"><span>${v.caption}</span> <button class="del-btn" onclick="deleteData('videos', ${v.id})"><i class="fas fa-trash"></i></button></div>
        `).join('');
    }

    // ‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§ ‡¶∏‡ßá‡¶≠
    async function saveOpinion() {
        const url = document.getElementById('o-url').value;
        await supabaseClient.from('opinions').insert([{ image_url: url }]);
        alert("‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§ ‡¶∏‡ßá‡¶≠ ‡¶π‡ßü‡ßá‡¶õ‡ßá"); loadOpinions();
    }

    async function loadOpinions() {
        const { data } = await supabaseClient.from('opinions').select('*');
        document.getElementById('opinion-list-dashboard').innerHTML = data.map(o => `
            <div class="preview-card"><img src="${o.image_url}"> <button class="del-btn" onclick="deleteData('opinions', ${o.id})"><i class="fas fa-trash"></i></button></div>
        `).join('');
    }

    // ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    async function deleteData(table, id) {
        if(confirm("‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶¨‡ßá‡¶®?")) {
            await supabaseClient.from(table).delete().eq('id', id);
            location.reload();
        }
    }

    window.onload = loadNews;
</script>
</body>
</html>
