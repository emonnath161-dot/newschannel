<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel | Adi Sonaton TV</title>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root { --blue: #1e3c72; --red: #e12229; --gray: #f4f7f6; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Hind Siliguri', sans-serif; }
        
        /* ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶™‡ßç‡¶∞‡ßã‡¶ü‡ßá‡¶ï‡¶∂‡¶® ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® */
        #login-overlay { position: fixed; inset: 0; background: var(--blue); z-index: 10000; display: flex; align-items: center; justify-content: center; flex-direction: column; color: white; }
        .login-box { background: white; padding: 30px; border-radius: 10px; color: #333; text-align: center; width: 300px; }
        
        body { background: var(--gray); display: flex; min-height: 100vh; }
        .sidebar { width: 260px; background: var(--blue); color: #fff; padding: 20px; position: fixed; height: 100vh; }
        .sidebar h2 { margin-bottom: 25px; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 10px; }
        .sidebar button { width: 100%; padding: 12px; margin-bottom: 10px; border: none; background: rgba(255,255,255,0.1); color: #fff; cursor: pointer; text-align: left; border-radius: 5px; font-weight: 600; font-size: 16px; }
        .sidebar button:hover { background: var(--red); }

        .main-content { margin-left: 260px; width: calc(100% - 260px); padding: 30px; }
        .section { background: #fff; padding: 25px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: none; }
        .active { display: block; }

        input, select, textarea { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .btn-add { background: #28a745; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-bottom: 15px; }
        .btn-submit { background: var(--blue); color: white; padding: 15px 30px; border: none; border-radius: 5px; width: 100%; font-weight: 700; cursor: pointer; }
        
        .dynamic-row { background: #f9f9f9; padding: 15px; border: 1px dashed #bbb; margin-bottom: 10px; position: relative; border-radius: 5px; }
        .btn-remove { background: var(--red); color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; position: absolute; top: 10px; right: 10px; }

        .list-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #ddd; align-items: center; }
        .list-item img { width: 60px; border-radius: 5px; }
    </style>
</head>
<body>

<div id="login-overlay">
    <div class="login-box">
        <h3>‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶®</h3><br>
        <input type="password" id="admin-pass" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®">
        <button class="btn-submit" onclick="checkPass()">‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>
</div>

<div class="sidebar">
    <h2>Adi Sonaton TV</h2>
    <button onclick="showSec('news-sec')">üì∞ ‡¶®‡¶ø‡¶â‡¶ú ‡¶Ü‡¶™‡¶≤‡ßã‡¶°</button>
    <button onclick="showSec('video-sec')">üé• ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø</button>
    <button onclick="showSec('opinion-sec')">‚úçÔ∏è ‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§ ‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°‡¶æ‡¶∞</button>
    <button onclick="location.href='index.html'" style="margin-top:50px; background:#000;">üè† ‡¶π‡ßã‡¶Æ‡¶™‡ßá‡¶ú</button>
</div>

<div class="main-content">
    <div id="news-sec" class="section active">
        <h3>üì∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶ ‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
        <input type="text" id="news-title" placeholder="‡¶∏‡¶Ç‡¶¨‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ">
        <select id="news-cat">
            <option value="bangladesh">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂</option>
            <option value="national">‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º</option>
            <option value="international">‡¶Ü‡¶®‡ßç‡¶§‡¶∞‡ßç‡¶ú‡¶æ‡¶§‡¶ø‡¶ï</option>
        </select>
        <input type="text" id="news-main-img" placeholder="‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï (Direct URL)">
        <textarea id="news-desc" rows="4" placeholder="‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶°‡ßá‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶®..."></textarea>
        
        <div id="extra-content"></div>
        <button class="btn-add" onclick="addMoreContent()">+ ‡¶Ü‡¶∞‡ßã ‡¶õ‡¶¨‡¶ø ‡¶ì ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        
        <button class="btn-submit" onclick="saveNews()">‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        <hr><br>
        <div id="news-list"></div>
    </div>

    <div id="video-sec" class="section">
        <h3>üé• ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü (‡ß¨‡¶ü‡¶ø)</h3>
        <input type="text" id="vid-url" placeholder="YouTube Embed ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï (src)">
        <input type="text" id="vid-cap" placeholder="‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ">
        <button class="btn-submit" onclick="saveVideo()">‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        <br><br>
        <div id="video-list"></div>
    </div>

    <div id="opinion-sec" class="section">
        <h3>‚úçÔ∏è ‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§ ‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°‡¶æ‡¶∞ (‡ßß‡ß¶-‡ßß‡ß´ ‡¶õ‡¶¨‡¶ø)</h3>
        <input type="text" id="op-img" placeholder="‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï (URL)">
        <button class="btn-submit" onclick="saveOpinion()">‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶°‡¶æ‡¶∞‡ßá ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        <br><br>
        <div id="opinion-list"></div>
    </div>
</div>

<script>
    const SUPABASE_URL = 'https://vplqtnrziptqeeusdabv.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZwbHF0bnJ6aXB0cWVldXNkYWJ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEwNDU1NDIsImV4cCI6MjA4NjYyMTU0Mn0.yMs0N0dMIImliu6PscOeKh_gYlvl184AESug-LVDKok';
    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    // ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶ö‡ßá‡¶ï (‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®)
    function checkPass() {
        const pass = document.getElementById('admin-pass').value;
        if(pass === "sonaton2026") { // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶®
            document.getElementById('login-overlay').style.display = 'none';
        } else {
            alert("‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°!");
        }
    }

    function showSec(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        if(id === 'news-sec') loadNews();
        if(id === 'video-sec') loadVideos();
        if(id === 'opinion-sec') loadOpinions();
    }

    // ‡¶®‡¶ø‡¶â‡¶ú ‡¶è‡¶∞ ‡¶≠‡ßá‡¶§‡¶∞ ‡¶°‡¶æ‡¶á‡¶®‡¶æ‡¶Æ‡¶ø‡¶ï ‡¶´‡¶ø‡¶≤‡ßç‡¶°
    function addMoreContent() {
        const div = document.createElement('div');
        div.className = 'dynamic-row';
        div.innerHTML = `
            <button class="btn-remove" onclick="this.parentElement.remove()">X</button>
            <input type="text" class="extra-img" placeholder="‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï">
            <textarea class="extra-desc" rows="2" placeholder="‡¶è‡¶á ‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ..."></textarea>
        `;
        document.getElementById('extra-content').appendChild(div);
    }

    // ‡¶®‡¶ø‡¶â‡¶ú ‡¶∏‡ßá‡¶≠
    async function saveNews() {
        const title = document.getElementById('news-title').value;
        const category = document.getElementById('news-cat').value;
        const image_url = document.getElementById('news-main-img').value;
        const content = document.getElementById('news-desc').value;

        // ‡¶è‡¶ï‡ßç‡¶∏‡¶ü‡ßç‡¶∞‡¶æ ‡¶õ‡¶¨‡¶ø ‡¶ì ‡¶≤‡ßá‡¶ñ‡¶æ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶∞‡ßá ‡¶§‡ßá ‡¶®‡ßá‡¶ì‡ßü‡¶æ
        const extraImgs = Array.from(document.querySelectorAll('.extra-img')).map(i => i.value);
        const extraDescs = Array.from(document.querySelectorAll('.extra-desc')).map(d => d.value);

        const { error } = await supabaseClient.from('news_portal').insert([{ 
            title, category, image_url, content,
            extra_images: extraImgs,
            extra_descriptions: extraDescs
        }]);

        if(!error) { alert("‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶π‡ßü‡ßá‡¶õ‡ßá!"); location.reload(); }
    }

    // ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∏‡ßá‡¶≠
    async function saveVideo() {
        const video_url = document.getElementById('vid-url').value;
        const caption = document.getElementById('vid-cap').value;
        const { error } = await supabaseClient.from('videos').insert([{ video_url, caption }]);
        if(!error) { alert("‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡ßü‡ßá‡¶õ‡ßá!"); loadVideos(); }
    }

    // ‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§ ‡¶∏‡ßá‡¶≠
    async function saveOpinion() {
        const image_url = document.getElementById('op-img').value;
        const { error } = await supabaseClient.from('opinions').insert([{ image_url }]);
        if(!error) { alert("‡¶Æ‡¶§‡¶æ‡¶Æ‡¶§ ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡ßü‡ßá‡¶õ‡ßá!"); loadOpinions(); }
    }

    // ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ì ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡ßá‡¶™‡ßá)
    async function loadNews() {
        const { data } = await supabaseClient.from('news_portal').select('*').order('id', {ascending: false});
        document.getElementById('news-list').innerHTML = data.map(n => `<div class="list-item"><span>${n.title}</span> <button class="btn-remove" onclick="del('news_portal',${n.id})">Del</button></div>`).join('');
    }
    async function loadVideos() {
        const { data } = await supabaseClient.from('videos').select('*');
        document.getElementById('video-list').innerHTML = data.map(v => `<div class="list-item"><span>${v.caption}</span> <button class="btn-remove" onclick="del('videos',${v.id})">Del</button></div>`).join('');
    }
    async function loadOpinions() {
        const { data } = await supabaseClient.from('opinions').select('*');
        document.getElementById('opinion-list').innerHTML = data.map(o => `<div class="list-item"><img src="${o.image_url}"> <button class="btn-remove" onclick="del('opinions',${o.id})">Del</button></div>`).join('');
    }

    async function del(table, id) {
        if(confirm('‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶¨‡ßá‡¶®?')) {
            await supabaseClient.from(table).delete().eq('id', id);
            location.reload();
        }
    }

    window.onload = loadNews;
</script>
</body>
</html>
