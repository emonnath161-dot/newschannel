<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>বিভাগ অনুযায়ী সংবাদ | Adi Sonaton TV</title>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: 'Hind Siliguri', sans-serif; background: #f4f7f9; margin: 0; }
        .container { max-width: 1100px; margin: 0 auto; padding: 20px; }
        .cat-header { background: white; padding: 20px; border-left: 10px solid #1e3c72; border-radius: 5px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-bottom: 30px; }
        .cat-title { font-size: 32px; color: #1e3c72; margin: 0; }
        .news-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .news-card { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .news-card img { width: 100%; height: 200px; object-fit: cover; }
        .news-card-content { padding: 15px; }
        .status-msg { text-align: center; font-size: 20px; color: #666; padding: 100px 0; }
        .back-link { text-decoration: none; color: #1e3c72; font-weight: bold; display: block; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="container">
    <a href="index.html" class="back-link">← হোমপেজে ফিরে যান</a>
    
    <div class="cat-header">
        <h2 class="cat-title" id="display-name">বিভাগ লোড হচ্ছে...</h2>
    </div>

    <div id="news-container" class="news-grid">
        <div class="status-msg">সংবাদ খোঁজা হচ্ছে...</div>
    </div>
</div>

<script>
    // ১. আপনার সঠিক Supabase তথ্য এখানে দিন
    const SUPABASE_URL = 'https://vplqtnrziptqeeusdabv.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZwbHF0bnJ6aXB0cWVldXNkYWJ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEwNDU1NDIsImV4cCI6MjA4NjYyMTU0Mn0.yMs0N0dMIImliu6PscOeKh_gYlvl184AESug-LVDKok';
    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    // ২. ম্যাপিং: ইংরেজি URL নাম থেকে বাংলায় রূপান্তর
    const categoryMap = {
        'bangladesh': 'বাংলাদেশ',
        'national': 'জাতীয়',
        'international': 'আন্তর্জাতিক',
        'sports': 'খেলা',
        'entertainment': 'বিনোদন',
        'tech-health': 'প্রযুক্তি ও চিকিৎসা',
        'opinion': 'মতামত',
        'organization': 'সংগঠন',
        'education': 'শিক্ষা',
        'theology': 'ধর্মতত্ব',
        'festivals': 'পূজাপার্বণ',
        'foundation': 'হিন্দু ফাউন্ডেশন'
    };

    // ৩. URL থেকে ক্যাটাগরি নেওয়া
    const urlParams = new URLSearchParams(window.location.search);
    const catParam = urlParams.get('page'); // যেমন: theology

    async function fetchCategoryNews() {
        // স্ক্রিনে নাম দেখানো (ম্যাপ থেকে বাংলা নাম নিবে)
        const banglaName = categoryMap[catParam] || catParam;
        document.getElementById('display-name').innerText = "বিভাগ: " + banglaName;

        // ৪. ডাটাবেজ থেকে ডাটা আনা (যেখানে ক্যাটাগরি একদম হুবহু মিলবে)
        const { data, error } = await supabaseClient
            .from('news_portal')
            .select('*')
            .eq('category', banglaName) // এডমিন প্যানেলে আপনি বাংলায় সেভ করছেন, তাই এখানেও বাংলায় খুঁজবে
            .order('id', { ascending: false });

        const container = document.getElementById('news-container');

        if (error) {
            container.innerHTML = '<div class="status-msg">এরর: ডাটা লোড করা যায়নি।</div>';
            return;
        }

        if (data && data.length > 0) {
            container.innerHTML = data.map(news => `
                <div class="news-card">
                    <img src="${news.image_url}" alt="">
                    <div class="news-card-content">
                        <h3 style="margin:0 0 10px 0; font-size:18px;">${news.title}</h3>
                        <p style="font-size:14px; color:#555;">${news.description ? news.description.substring(0, 100) : ''}...</p>
                    </div>
                </div>
            `).join('');
        } else {
            container.innerHTML = `<div class="status-msg">"${banglaName}" বিভাগে বর্তমানে কোনো নিউজ নেই।</div>`;
        }
    }

    fetchCategoryNews();
</script>

</body>
</html>
